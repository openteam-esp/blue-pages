<%= semantic_nested_form_for @subdivision, :validate => true, :url => @subdivision.new_record? ? collection_path : resource_path do |form| %>
  <%= form.inputs do %>
    <%= form.input :title %>
    <%= form.input :abbr %>
    <%= form.input :url, :as => :string %>
  <% end %>

  <% @subdivision.build_building unless @subdivision.building %>
  <%= form.inputs :for => :building do | building_form | %>
    <%= building_form.input :postcode %>
    <%= building_form.input :region %>
    <%= building_form.input :district %>
    <%= building_form.input :locality %>
    <%= building_form.input :street %>
    <%= building_form.input :house %>
    <%= building_form.input :building %>
  <% end %>

  <%= form.semantic_fields_for :phones do |phone_form| %>
    <%= phone_form.inputs do %>
      <%= phone_form.input :code, :wrapper_html => {:class => phone_form.object.kind_internal? ? 'hidden' : 'blank'} %>
      <%= phone_form.input :number %>
      <%= phone_form.input :additional_number %>
      <%= phone_form.input :kind, :as => :select, :collection => Phone.values_for_select_tag(:kind), :input_html => { :class => 'phone_kind'} %>
      <li><%= phone_form.link_to_remove t('active_admin.delete_phone'), :class => 'button icon trash danger' %></li>
    <% end %>
  <% end %>

  <div class="phones_fieldset">
    <%= form.link_to_add t('active_admin.new_phone'), :phones, :class => 'button icon add' %>
  </div>

  <%= form.fields_for :emails do |email_form| %>
    <%= email_form.inputs do %>
      <%= email_form.input :address %>
      <li><%= email_form.link_to_remove t('active_admin.delete_email'), :class => 'button icon trash danger' %></li>
    <% end %>
  <% end %>

  <div class="emails_fieldset">
    <%= form.link_to_add t('active_admin.new_email'), :emails, :class => 'button icon add' %>
  </div>

  <%= form.buttons do %>
    <%= form.commit_button %>
    <li class='cancel'>
      <%= link_to t("active_admin.cancel"), @subdivision.new_record? ? collection_path : resource_path %>
    </li>
  <% end %>
<% end %>
