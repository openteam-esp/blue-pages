<%= semantic_form_for @user, :url => @user.new_record? ? admin_users_path : admin_user_path(@user) do |form| %>
  <%= form.inputs do %>
    <%= form.input :name %>
    <%= form.input :email %>
    <%= form.input :password %>
    <%= form.input :password_confirmation %>

    <li class="check_boxes">
      <fieldset class="choices">
        <legend class="label"><label>Подразделения</label></legend>
        <input id="user_categories_none" name="user[category_ids][]" type="hidden" value="" />
        <ol class="choice_categories">
          <% current_user.manageable_categories.each_with_index do |category, index| %>
            <li class="depth_<%= category.depth %>">
              <%= content_tag :label, :for => "user_category_ids_#{category.id}" do %>
                <%= check_box_tag "user[category_ids][]",
                  category.id,
                  @user.categories.include?(category),
                  :id => "user_category_ids_#{category.id}" %>
                <%= category.title %>
              <% end %>
            </li>
          <% end %>
        </ol>
      </fieldset>
    </li>
  <% end %>

  <%= form.buttons do %>
    <%= form.commit_button %>
    <li class='cancel'>
      <%= link_to t("active_admin.cancel"), @user.new_record? ? admin_users_path : admin_user_path(@user) %>
    </li>
  <% end %>
<% end %>
